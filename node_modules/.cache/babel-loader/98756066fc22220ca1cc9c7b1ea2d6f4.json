{"ast":null,"code":"import _regeneratorRuntime from\"/Users/artemparhomenko/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/artemparhomenko/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/artemparhomenko/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{authAPI}from\"../api/api\";import{catchingErrors}from'../utilities/CatchErrors/catchingError';var SET_USER_DATA='SET_USER_DATA';var SET_CAPTCHA='SET_CAPTCHA';var initialState={id:null,email:null,login:null,isFetching:false,isAuth:false,captcha:null};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread(_objectSpread({},state),action.payload);case SET_CAPTCHA:return _objectSpread(_objectSpread({},state),{},{captcha:action.captcha});default:return state;}};export var setUserData=function setUserData(id,email,login,isAuth){return{type:SET_USER_DATA,payload:{id:id,email:email,login:login,isAuth:isAuth}};};export var setCaptcha=function setCaptcha(captcha){return{type:SET_CAPTCHA,captcha:captcha};};export var getCaptcha=function getCaptcha(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response,captcha;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.getCaptcha();case 2:response=_context.sent;if(response.url){captcha=response.url;dispatch(setCaptcha(captcha));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var getYourProfile=function getYourProfile(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var response,_response$data,id,email,_login;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return authAPI.getYourProfile();case 3:response=_context2.sent;if(response.resultCode===0){_response$data=response.data,id=_response$data.id,email=_response$data.email,_login=_response$data.login;dispatch(setUserData(id,email,_login,true));}_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);catchingErrors(_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var login=function login(email,password,rememberMe,captcha){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.login(email,password,rememberMe,captcha);case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(getYourProfile());}else if(response.data.resultCode===10){dispatch(getCaptcha());}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return authAPI.logout();case 2:response=_context4.sent;if(response.data.resultCode===0){dispatch(setUserData(null,null,null,false));}case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"names":["authAPI","catchingErrors","SET_USER_DATA","SET_CAPTCHA","initialState","id","email","login","isFetching","isAuth","captcha","authReducer","state","action","type","payload","setUserData","setCaptcha","getCaptcha","dispatch","response","url","getYourProfile","resultCode","data","password","rememberMe","logout"],"sources":["/Users/artemparhomenko/my-app/src/redux/auth-reducer.js"],"sourcesContent":["import { authAPI } from \"../api/api\"\nimport { catchingErrors } from '../utilities/CatchErrors/catchingError'\n\nconst SET_USER_DATA = 'SET_USER_DATA'\nconst SET_CAPTCHA = 'SET_CAPTCHA'\n\nlet initialState = {\n    id: null,\n    email: null,\n    login: null,\n    isFetching: false,\n    isAuth: false,\n    captcha: null\n};\n\nconst authReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case SET_USER_DATA:\n            return {\n                ...state,\n                ...action.payload\n            };\n        case SET_CAPTCHA:\n            return {\n                ...state,\n                captcha: action.captcha\n            };\n        default:\n            return state;\n    }\n}\n\nexport const setUserData = (id, email, login, isAuth) => ({ type: SET_USER_DATA, payload: { id, email, login, isAuth } })\nexport const setCaptcha = (captcha) => ({ type: SET_CAPTCHA, captcha })\n\nexport const getCaptcha = () => async (dispatch) => {\n    const response = await authAPI.getCaptcha()\n    if (response.url) {\n        const captcha = response.url\n        dispatch(setCaptcha(captcha))\n    }\n}\n\nexport const getYourProfile = () => async (dispatch) => {\n    try {\n        let response = await authAPI.getYourProfile()\n        if (response.resultCode === 0) {\n            let { id, email, login } = response.data\n            dispatch(setUserData(id, email, login, true))\n        }\n    } catch (error) {catchingErrors(error)}\n}\n\nexport const login = (email, password, rememberMe, captcha) => async (dispatch) => {\n    let response = await authAPI.login(email, password, rememberMe, captcha)\n    if (response.data.resultCode === 0) {\n        dispatch(getYourProfile())\n    } else if (response.data.resultCode === 10) {\n        dispatch(getCaptcha())\n    }\n}\n\nexport const logout = () => async (dispatch) => {\n    let response = await authAPI.logout()\n    if (response.data.resultCode === 0) {\n        dispatch(setUserData(null, null, null, false))\n    }\n\n}\n\nexport default authReducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}