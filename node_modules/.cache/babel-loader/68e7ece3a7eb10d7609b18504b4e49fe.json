{"ast":null,"code":"import _regeneratorRuntime from\"/Users/artemparhomenko/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/artemparhomenko/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/artemparhomenko/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/artemparhomenko/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{usersAPI}from\"../api/api\";// import { changeObjectInArray } from \"../utilits/update-object\";\nvar FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET-USERS';var SET_CURRENT_PAGE='SET-CURRENT-PAGE';var SET_TOTAL_USERS_COUNT='SET-TOTAL-USERS-COUNT';var TOGGLE_IS_FETCHING='TOGGLE-IS-FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='TOGGLE_IS_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:5,totalUserCount:0,currentPage:1,isFetching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{// users: changeObjectInArray(state.users, action.userId, 'id', {followed: true})\nusers:state.users.map(function(u){if(u.id===action.userId){return _objectSpread(_objectSpread({},u),{},{followed:u.followed=true});};return u;})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{// users: changeObjectInArray(state.users, action.userId, 'id', {followed: false})\nusers:state.users.map(function(u){if(u.id===action.userId){return _objectSpread(_objectSpread({},u),{},{followed:u.followed=false});};return u;})});case SET_USERS:return _objectSpread(_objectSpread({},state),{},{users:action.users});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});case SET_TOTAL_USERS_COUNT:return _objectSpread(_objectSpread({},state),{},{totalUserCount:action.totalCount});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case TOGGLE_IS_FOLLOWING_PROGRESS:return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!=action.userId;})});default:return state;}};export var setTotalUsersCount=function setTotalUsersCount(totalCount){return{type:SET_TOTAL_USERS_COUNT,totalCount:totalCount};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var follow=function follow(userId){return{type:FOLLOW,userId:userId};};export var unfollow=function unfollow(userId){return{type:UNFOLLOW,userId:userId};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching:isFetching,userId:userId};};export var getUsersThunkCreator=function getUsersThunkCreator(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));_context.next=3;return usersAPI.getUsers(currentPage,pageSize);case 3:response=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(response.items));dispatch(setTotalUsersCount(response.totalCount));case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var changePageThunkCreator=function changePageThunkCreator(pageNumber,pageSize){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleIsFetching(true));dispatch(setCurrentPage(pageNumber));_context2.next=4;return usersAPI.getUsers(pageNumber,pageSize);case 4:response=_context2.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(response.items));dispatch(setTotalUsersCount(response.totalCount));case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};var followUnfollow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch,id,apiMethod,actionCreator){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleFollowingProgress(true,id));_context3.next=3;return apiMethod(id);case 3:response=_context3.sent;if(response.resultCode===0){dispatch(actionCreator(id));}dispatch(toggleFollowingProgress(false,id));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function followUnfollow(_x3,_x4,_x5,_x6){return _ref3.apply(this,arguments);};}();export var unfollowThunkCreator=function unfollowThunkCreator(id){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:followUnfollow(dispatch,id,usersAPI.unfollow.bind(usersAPI),unfollow);case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x7){return _ref4.apply(this,arguments);};}();};export var followThunkCreator=function followThunkCreator(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(dispatch){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:followUnfollow(dispatch,id,usersAPI.follow.bind(usersAPI),follow);case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x8){return _ref5.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUserCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","map","u","id","userId","followed","totalCount","filter","setTotalUsersCount","setCurrentPage","setUsers","follow","unfollow","toggleIsFetching","toggleFollowingProgress","getUsersThunkCreator","dispatch","getUsers","response","items","changePageThunkCreator","pageNumber","followUnfollow","apiMethod","actionCreator","resultCode","unfollowThunkCreator","bind","followThunkCreator"],"sources":["/Users/artemparhomenko/my-app/src/redux/users-reducer.js"],"sourcesContent":["import { usersAPI } from \"../api/api\";\n// import { changeObjectInArray } from \"../utilits/update-object\";\n\nconst FOLLOW = 'FOLLOW';\nconst UNFOLLOW = 'UNFOLLOW';\nconst SET_USERS = 'SET-USERS';\nconst SET_CURRENT_PAGE = 'SET-CURRENT-PAGE';\nconst SET_TOTAL_USERS_COUNT = 'SET-TOTAL-USERS-COUNT'\nconst TOGGLE_IS_FETCHING = 'TOGGLE-IS-FETCHING'\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE_IS_FOLLOWING_PROGRESS'\n\nlet initialState = {\n    users: [],\n    pageSize: 5,\n    totalUserCount: 0,\n    currentPage: 1,\n    isFetching: false,\n    followingInProgress: []\n}\n\nconst usersReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case FOLLOW:\n            return {\n                ...state,\n                // users: changeObjectInArray(state.users, action.userId, 'id', {followed: true})\n                users: state.users.map(u => {\n                    if (u.id === action.userId) {\n                        return { ...u, followed: u.followed = true }\n                    };\n                    return u;\n                })\n            };\n        case UNFOLLOW:\n            return {\n                ...state,\n                // users: changeObjectInArray(state.users, action.userId, 'id', {followed: false})\n                users: state.users.map(u => {\n                    if (u.id === action.userId) {\n                        return { ...u, followed: u.followed = false }\n                    };\n                    return u;\n                })\n            };\n        case SET_USERS:\n            return {\n                ...state,\n                users: action.users\n            }\n        case SET_CURRENT_PAGE:\n            return {\n                ...state,\n                currentPage: action.currentPage\n            };\n        case SET_TOTAL_USERS_COUNT:\n            return {\n                ...state,\n                totalUserCount: action.totalCount\n            };\n        case TOGGLE_IS_FETCHING:\n            return {\n                ...state,\n                isFetching: action.isFetching\n            };\n        case TOGGLE_IS_FOLLOWING_PROGRESS:\n            return {\n                ...state,\n                followingInProgress: action.isFetching\n                    ? [...state.followingInProgress, action.userId]\n                    : state.followingInProgress.filter(id => id != action.userId)\n            };\n        default:\n            return state;\n    }\n};\nexport const setTotalUsersCount = (totalCount) => ({ type: SET_TOTAL_USERS_COUNT, totalCount });\nexport const setCurrentPage = (currentPage) => ({ type: SET_CURRENT_PAGE, currentPage });\nexport const setUsers = (users) => ({ type: SET_USERS, users });\nexport const follow = (userId) => ({ type: FOLLOW, userId });\nexport const unfollow = (userId) => ({ type: UNFOLLOW, userId });\nexport const toggleIsFetching = (isFetching) => ({ type: TOGGLE_IS_FETCHING, isFetching });\nexport const toggleFollowingProgress = (isFetching, userId) => ({ type: TOGGLE_IS_FOLLOWING_PROGRESS, isFetching, userId });\n\nexport const getUsersThunkCreator = (currentPage, pageSize) => async (dispatch) => {\n    dispatch(toggleIsFetching(true))\n    let response = await usersAPI.getUsers(currentPage, pageSize)\n    dispatch(toggleIsFetching(false))\n    dispatch(setUsers(response.items))\n    dispatch(setTotalUsersCount(response.totalCount))\n}\nexport const changePageThunkCreator = (pageNumber, pageSize) => async (dispatch) => {\n    dispatch(toggleIsFetching(true))\n    dispatch(setCurrentPage(pageNumber))\n    let response = await usersAPI.getUsers(pageNumber, pageSize)\n    dispatch(toggleIsFetching(false))\n    dispatch(setUsers(response.items))\n    dispatch(setTotalUsersCount(response.totalCount))\n}\n\nconst followUnfollow = async (dispatch, id, apiMethod, actionCreator) => {\n    dispatch(toggleFollowingProgress(true, id))\n    let response = await apiMethod(id)\n    if (response.resultCode === 0) {\n        dispatch(actionCreator(id))\n    }\n    dispatch(toggleFollowingProgress(false, id))\n}\n\nexport const unfollowThunkCreator = (id) => async (dispatch) => {\n    followUnfollow(dispatch, id, usersAPI.unfollow.bind(usersAPI), unfollow)\n}\nexport const followThunkCreator = (id) => async (dispatch) => {\n    followUnfollow(dispatch, id, usersAPI.follow.bind(usersAPI), follow)\n}\n\nexport default usersReducer;\n"],"mappings":"meAAA,OAASA,QAAT,KAAyB,YAAzB,CACA;AAEA,GAAMC,OAAM,CAAG,QAAf,CACA,GAAMC,SAAQ,CAAG,UAAjB,CACA,GAAMC,UAAS,CAAG,WAAlB,CACA,GAAMC,iBAAgB,CAAG,kBAAzB,CACA,GAAMC,sBAAqB,CAAG,uBAA9B,CACA,GAAMC,mBAAkB,CAAG,oBAA3B,CACA,GAAMC,6BAA4B,CAAG,8BAArC,CAEA,GAAIC,aAAY,CAAG,CACfC,KAAK,CAAE,EADQ,CAEfC,QAAQ,CAAE,CAFK,CAGfC,cAAc,CAAE,CAHD,CAIfC,WAAW,CAAE,CAJE,CAKfC,UAAU,CAAE,KALG,CAMfC,mBAAmB,CAAE,EANN,CAAnB,CASA,GAAMC,aAAY,CAAG,QAAfA,aAAe,EAAkC,IAAjCC,MAAiC,2DAAzBR,YAAyB,IAAXS,OAAW,2CACnD,OAAQA,MAAM,CAACC,IAAf,EACI,IAAKjB,OAAL,CACI,sCACOe,KADP,MAEI;AACAP,KAAK,CAAEO,KAAK,CAACP,KAAN,CAAYU,GAAZ,CAAgB,SAAAC,CAAC,CAAI,CACxB,GAAIA,CAAC,CAACC,EAAF,GAASJ,MAAM,CAACK,MAApB,CAA4B,CACxB,sCAAYF,CAAZ,MAAeG,QAAQ,CAAEH,CAAC,CAACG,QAAF,CAAa,IAAtC,GACH,EACD,MAAOH,EAAP,CACH,CALM,CAHX,GAUJ,IAAKlB,SAAL,CACI,sCACOc,KADP,MAEI;AACAP,KAAK,CAAEO,KAAK,CAACP,KAAN,CAAYU,GAAZ,CAAgB,SAAAC,CAAC,CAAI,CACxB,GAAIA,CAAC,CAACC,EAAF,GAASJ,MAAM,CAACK,MAApB,CAA4B,CACxB,sCAAYF,CAAZ,MAAeG,QAAQ,CAAEH,CAAC,CAACG,QAAF,CAAa,KAAtC,GACH,EACD,MAAOH,EAAP,CACH,CALM,CAHX,GAUJ,IAAKjB,UAAL,CACI,sCACOa,KADP,MAEIP,KAAK,CAAEQ,MAAM,CAACR,KAFlB,GAIJ,IAAKL,iBAAL,CACI,sCACOY,KADP,MAEIJ,WAAW,CAAEK,MAAM,CAACL,WAFxB,GAIJ,IAAKP,sBAAL,CACI,sCACOW,KADP,MAEIL,cAAc,CAAEM,MAAM,CAACO,UAF3B,GAIJ,IAAKlB,mBAAL,CACI,sCACOU,KADP,MAEIH,UAAU,CAAEI,MAAM,CAACJ,UAFvB,GAIJ,IAAKN,6BAAL,CACI,sCACOS,KADP,MAEIF,mBAAmB,CAAEG,MAAM,CAACJ,UAAP,8BACXG,KAAK,CAACF,mBADK,GACgBG,MAAM,CAACK,MADvB,GAEfN,KAAK,CAACF,mBAAN,CAA0BW,MAA1B,CAAiC,SAAAJ,EAAE,QAAIA,GAAE,EAAIJ,MAAM,CAACK,MAAjB,EAAnC,CAJV,GAMJ,QACI,MAAON,MAAP,CAnDR,CAqDH,CAtDD,CAuDA,MAAO,IAAMU,mBAAkB,CAAG,QAArBA,mBAAqB,CAACF,UAAD,QAAiB,CAAEN,IAAI,CAAEb,qBAAR,CAA+BmB,UAAU,CAAVA,UAA/B,CAAjB,EAA3B,CACP,MAAO,IAAMG,eAAc,CAAG,QAAjBA,eAAiB,CAACf,WAAD,QAAkB,CAAEM,IAAI,CAAEd,gBAAR,CAA0BQ,WAAW,CAAXA,WAA1B,CAAlB,EAAvB,CACP,MAAO,IAAMgB,SAAQ,CAAG,QAAXA,SAAW,CAACnB,KAAD,QAAY,CAAES,IAAI,CAAEf,SAAR,CAAmBM,KAAK,CAALA,KAAnB,CAAZ,EAAjB,CACP,MAAO,IAAMoB,OAAM,CAAG,QAATA,OAAS,CAACP,MAAD,QAAa,CAAEJ,IAAI,CAAEjB,MAAR,CAAgBqB,MAAM,CAANA,MAAhB,CAAb,EAAf,CACP,MAAO,IAAMQ,SAAQ,CAAG,QAAXA,SAAW,CAACR,MAAD,QAAa,CAAEJ,IAAI,CAAEhB,QAAR,CAAkBoB,MAAM,CAANA,MAAlB,CAAb,EAAjB,CACP,MAAO,IAAMS,iBAAgB,CAAG,QAAnBA,iBAAmB,CAAClB,UAAD,QAAiB,CAAEK,IAAI,CAAEZ,kBAAR,CAA4BO,UAAU,CAAVA,UAA5B,CAAjB,EAAzB,CACP,MAAO,IAAMmB,wBAAuB,CAAG,QAA1BA,wBAA0B,CAACnB,UAAD,CAAaS,MAAb,QAAyB,CAAEJ,IAAI,CAAEX,4BAAR,CAAsCM,UAAU,CAAVA,UAAtC,CAAkDS,MAAM,CAANA,MAAlD,CAAzB,EAAhC,CAEP,MAAO,IAAMW,qBAAoB,CAAG,QAAvBA,qBAAuB,CAACrB,WAAD,CAAcF,QAAd,mGAA2B,iBAAOwB,QAAP,iIAC3DA,QAAQ,CAACH,gBAAgB,CAAC,IAAD,CAAjB,CAAR,CAD2D,sBAEtC/B,SAAQ,CAACmC,QAAT,CAAkBvB,WAAlB,CAA+BF,QAA/B,CAFsC,QAEvD0B,QAFuD,eAG3DF,QAAQ,CAACH,gBAAgB,CAAC,KAAD,CAAjB,CAAR,CACAG,QAAQ,CAACN,QAAQ,CAACQ,QAAQ,CAACC,KAAV,CAAT,CAAR,CACAH,QAAQ,CAACR,kBAAkB,CAACU,QAAQ,CAACZ,UAAV,CAAnB,CAAR,CAL2D,sDAA3B,gEAA7B,CAOP,MAAO,IAAMc,uBAAsB,CAAG,QAAzBA,uBAAyB,CAACC,UAAD,CAAa7B,QAAb,oGAA0B,kBAAOwB,QAAP,qIAC5DA,QAAQ,CAACH,gBAAgB,CAAC,IAAD,CAAjB,CAAR,CACAG,QAAQ,CAACP,cAAc,CAACY,UAAD,CAAf,CAAR,CAF4D,uBAGvCvC,SAAQ,CAACmC,QAAT,CAAkBI,UAAlB,CAA8B7B,QAA9B,CAHuC,QAGxD0B,QAHwD,gBAI5DF,QAAQ,CAACH,gBAAgB,CAAC,KAAD,CAAjB,CAAR,CACAG,QAAQ,CAACN,QAAQ,CAACQ,QAAQ,CAACC,KAAV,CAAT,CAAR,CACAH,QAAQ,CAACR,kBAAkB,CAACU,QAAQ,CAACZ,UAAV,CAAnB,CAAR,CAN4D,wDAA1B,kEAA/B,CASP,GAAMgB,eAAc,6FAAG,kBAAON,QAAP,CAAiBb,EAAjB,CAAqBoB,SAArB,CAAgCC,aAAhC,qIACnBR,QAAQ,CAACF,uBAAuB,CAAC,IAAD,CAAOX,EAAP,CAAxB,CAAR,CADmB,uBAEEoB,UAAS,CAACpB,EAAD,CAFX,QAEfe,QAFe,gBAGnB,GAAIA,QAAQ,CAACO,UAAT,GAAwB,CAA5B,CAA+B,CAC3BT,QAAQ,CAACQ,aAAa,CAACrB,EAAD,CAAd,CAAR,CACH,CACDa,QAAQ,CAACF,uBAAuB,CAAC,KAAD,CAAQX,EAAR,CAAxB,CAAR,CANmB,wDAAH,kBAAdmB,eAAc,0DAApB,CASA,MAAO,IAAMI,qBAAoB,CAAG,QAAvBA,qBAAuB,CAACvB,EAAD,oGAAQ,kBAAOa,QAAP,wHACxCM,cAAc,CAACN,QAAD,CAAWb,EAAX,CAAerB,QAAQ,CAAC8B,QAAT,CAAkBe,IAAlB,CAAuB7C,QAAvB,CAAf,CAAiD8B,QAAjD,CAAd,CADwC,wDAAR,kEAA7B,CAGP,MAAO,IAAMgB,mBAAkB,CAAG,QAArBA,mBAAqB,CAACzB,EAAD,oGAAQ,kBAAOa,QAAP,wHACtCM,cAAc,CAACN,QAAD,CAAWb,EAAX,CAAerB,QAAQ,CAAC6B,MAAT,CAAgBgB,IAAhB,CAAqB7C,QAArB,CAAf,CAA+C6B,MAA/C,CAAd,CADsC,wDAAR,kEAA3B,CAIP,cAAed,aAAf"},"metadata":{},"sourceType":"module"}